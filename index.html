
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üêù ÁâõËßíÁìúËúÇÂ†¥Ë™ûÈü≥ÁÆ°ÁêÜÁ≥ªÁµ±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Taisho Gothic, 'ÂæÆËªüÊ≠£ÈªëÈ´î', sans-serif;
            background: linear-gradient(135deg, #FFA500 0%, #FF6B35 50%, #FF8C00 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #FF8C00 0%, #FF6B35 100%);
            color: white;
            padding: 40px;
            text-align: center;
            position: relative;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="10" cy="10" r="2" fill="rgba(255,255,255,0.1)"/><circle cx="30" cy="25" r="1.5" fill="rgba(255,255,255,0.1)"/><circle cx="60" cy="15" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="80" cy="30" r="2.5" fill="rgba(255,255,255,0.1)"/></svg>');
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .main-content {
            padding: 40px;
        }

        .demo-section {
            margin-bottom: 40px;
        }

        .section-title {
            font-size: 1.8rem;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .voice-demo {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .voice-demo::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, #FF8C00, #FF6B35, #4CAF50);
        }

        .voice-input {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .voice-button {
            background: linear-gradient(135deg, #FF6B35, #FF8C00);
            color: white;
            border: none;
            border-radius: 50%;
            width: 80px;
            height: 80px;
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
        }

        .voice-button:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(255, 107, 53, 0.4);
        }

        .voice-button.recording {
            animation: pulse 1.5s infinite;
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .voice-text {
            flex: 1;
            background: white;
            border: 2px solid #eee;
            border-radius: 10px;
            padding: 15px;
            font-size: 1.1rem;
            min-height: 60px;
            display: flex;
            align-items: center;
        }

        .voice-text.listening {
            border-color: #FF6B35;
            box-shadow: 0 0 10px rgba(255, 107, 53, 0.2);
        }

        .gap-form {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            margin-top: 20px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }

        .form-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #eee;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #FF6B35;
            box-shadow: 0 0 5px rgba(255, 107, 53, 0.2);
        }

        .form-input.auto-filled {
            background: #e8f5e8;
            border-color: #4CAF50;
        }

        .timeline-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
        }

        .timeline {
            position: relative;
            padding-left: 30px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 15px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(to bottom, #FF8C00, #FF6B35, #4CAF50);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -37px;
            top: 20px;
            width: 12px;
            height: 12px;
            background: #FF6B35;
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 0 0 2px #FF6B35;
        }

        .timeline-date {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 5px;
        }

        .timeline-task {
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
        }

        .timeline-details {
            color: #666;
            font-size: 0.95rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #FF6B35;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 0.9rem;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #FF6B35, #FF8C00);
            color: white;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4CAF50;
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            background: #e74c3c;
        }

        .notification.warning {
            background: #f39c12;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .voice-input {
                flex-direction: column;
                text-align: center;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üêù ÁâõËßíÁìúËúÇÂ†¥Ë™ûÈü≥ÁÆ°ÁêÜÁ≥ªÁµ±</h1>
            <p>Êô∫ÊÖßË™ûÈü≥Ë®òÈåÑ √ó GAPË™çË≠âÁÆ°ÁêÜ √ó Â∞àÊ•≠ËúÇÂ†¥Á≥ªÁµ±</p>
        </div>

        <div class="main-content">
            <!-- Ë™ûÈü≥Ëº∏ÂÖ•ÂçÄÂüü -->
            <div class="demo-section">
                <h2 class="section-title">
                    üé§ Ë™ûÈü≥Ë®òÈåÑÂçÄÂüü
                </h2>
                
                <div class="voice-demo">
                    <div class="voice-input">
                        <button class="voice-button" id="voiceBtn">üé§</button>
                        <div class="voice-text" id="voiceText">
                            ÈªûÊìäÈ∫•ÂÖãÈ¢®ÈñãÂßãË™ûÈü≥Ë®òÈåÑ...
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="simulateVoiceInput('Êò•ÁπÅ')">
                            üå∏ Ê®°Êì¨Êò•ÁπÅË®òÈåÑ
                        </button>
                        <button class="btn btn-primary" onclick="simulateVoiceInput('ÂàÜËúÇ')">
                            üëë Ê®°Êì¨ÂàÜËúÇË®òÈåÑ
                        </button>
                        <button class="btn btn-primary" onclick="simulateVoiceInput('Êé°Ëúú')">
                            üçØ Ê®°Êì¨Êé°ËúúË®òÈåÑ
                        </button>
                    </div>
                </div>
            </div>

            <!-- GAPË°®ÂñÆÂçÄÂüü -->
            <div class="demo-section">
                <h2 class="section-title">
                    üìã GAP Ë™çË≠âË°®ÂñÆ
                </h2>
                
                <div class="gap-form">
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Ë®òÈåÑÊó•Êúü</label>
                            <input type="date" class="form-input" id="recordDate" />
                        </div>
                        <div class="form-group">
                            <label class="form-label">Ëæ≤Â†¥ÂêçÁ®±</label>
                            <input type="text" class="form-input" id="farmName" value="Ë®±ËÉΩÂéüËúÇÂ†¥" />
                        </div>
                        <div class="form-group">
                            <label class="form-label">ÁîüÁî¢ËÄÖÂßìÂêç</label>
                            <input type="text" class="form-input" id="producerName" value="Ë®±ËÉΩÂéü" />
                        </div>
                        <div class="form-group">
                            <label class="form-label">Â§©Ê∞£ÁãÄÊ≥Å</label>
                            <select class="form-input" id="weather">
                                <option value="">Ë´ãÈÅ∏Êìá</option>
                                <option value="Êô¥">‚òÄÔ∏è Êô¥</option>
                                <option value="Èõ®">üåßÔ∏è Èõ®</option>
                                <option value="Èô∞">‚òÅÔ∏è Èô∞</option>
                                <option value="Â§öÈõ≤">‚õÖ Â§öÈõ≤</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ËúÇÂ†¥‰ΩçÁΩÆËàáÁ∑®Ëôü</label>
                            <input type="text" class="form-input" id="location" />
                        </div>
                        <div class="form-group">
                            <label class="form-label">‰ΩúÊ•≠È†ÖÁõÆ</label>
                            <input type="text" class="form-input" id="task" />
                        </div>
                        <div class="form-group">
                            <label class="form-label">ÁâõËßíÁìúÈñãËä±ÊÉÖÊ≥Å</label>
                            <select class="form-input" id="flowering">
                                <option value="">Ë´ãÈÅ∏Êìá</option>
                                <option value="ÁÑ°">ÁÑ°</option>
                                <option value="Â∞ëÈáè">üå∏ Â∞ëÈáè</option>
                                <option value="‰∏≠Á≠â">üå∫ ‰∏≠Á≠â</option>
                                <option value="Â§ßÈáè">üåª Â§ßÈáè</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Êé°Ëä±Ë∑°Ë±°</label>
                            <select class="form-input" id="foraging">
                                <option value="">Ë´ãÈÅ∏Êìá</option>
                                <option value="ÊòØ">‚úÖ ÊòØ</option>
                                <option value="Âê¶">‚ùå Âê¶</option>
                                <option value="‰∏çÁ¢∫ÂÆö">‚ùì ‰∏çÁ¢∫ÂÆö</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Ë≥áÊùêÂêçÁ®±</label>
                            <input type="text" class="form-input" id="material" />
                        </div>
                        <div class="form-group">
                            <label class="form-label">‰ΩøÁî®Èáè</label>
                            <input type="text" class="form-input" id="quantity" />
                        </div>
                        <div class="form-group">
                            <label class="form-label">Êé°Êî∂Èáè (kg)</label>
                            <input type="number" class="form-input" id="harvest" step="0.1" />
                        </div>
                        <div class="form-group">
                            <label class="form-label">ÂÇôË®ª</label>
                            <textarea class="form-input" id="notes" rows="3"></textarea>
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn btn-success" onclick="saveRecord()">
                            üíæ ÂÑ≤Â≠òË®òÈåÑ
                        </button>
                        <button class="btn btn-secondary" onclick="clearForm()">
                            üóëÔ∏è Ê∏ÖÁ©∫Ë°®ÂñÆ
                        </button>
                    </div>
                </div>
            </div>

            <!-- ËúÇÂ†¥ÁÆ°ÁêÜÊôÇÈñìËª∏ -->
            <div class="demo-section">
                <h2 class="section-title">
                    üìÖ ËúÇÂ†¥ÁÆ°ÁêÜÊôÇÈñìËª∏
                </h2>
                
                <div class="timeline-section">
                    <div class="timeline" id="timeline">
                        <!-- ÊôÇÈñìËª∏È†ÖÁõÆÂ∞áÁî± JavaScript ÂãïÊÖãÁîüÊàê -->
                    </div>
                </div>
            </div>

            <!-- Áµ±Ë®àË≥áË®ä -->
            <div class="demo-section">
                <h2 class="section-title">
                    üìä ËúÇÂ†¥Áµ±Ë®àË≥áË®ä
                </h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üìù</div>
                        <div class="stat-number" id="totalRecords">0</div>
                        <div class="stat-label">Á∏ΩË®òÈåÑÊï∏</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üçØ</div>
                        <div class="stat-number" id="totalHoney">0</div>
                        <div class="stat-label">Á∏ΩÊé°Êî∂Èáè (kg)</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üè†</div>
                        <div class="stat-number" id="activeAreas">0</div>
                        <div class="stat-label">Ê¥ªË∫çÂçÄÂüü</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üå∏</div>
                        <div class="stat-number" id="currentSeason">Êò•ÁπÅÊúü</div>
                        <div class="stat-label">Áï∂ÂâçÂ≠£ÁØÄ</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ÈÄöÁü•Ë®äÊÅØ -->
    <div class="notification" id="notification"></div>

    <script>
        // ËúÇÂ†¥ÁÆ°ÁêÜÁ≥ªÁµ± JavaScript
        class BeekeepingVoiceSystem {
            constructor() {
                this.isRecording = false;
                this.records = JSON.parse(localStorage.getItem('beekeepingRecords') || '[]');
                this.currentSeason = this.getCurrentSeason();
                
                this.initializeSystem();
                this.setupEventListeners();
                this.loadData();
            }

            getCurrentSeason() {
                const now = new Date();
                const month = now.getMonth() + 1;
                const day = now.getDate();
                
                if ((month === 1 && day >= 20) || (month === 2) || (month === 3 && day <= 20)) {
                    return 'Êò•ÁπÅÊúü';
                } else if ((month === 3 && day >= 21) || (month === 4) || (month === 5 && day <= 15)) {
                    return 'ÂàÜËúÇÊúü';
                } else if ((month === 5 && day >= 16) || month <= 8) {
                    return 'Êé°ËúúÊúü';
                } else if (month >= 9 && (month < 11 || (month === 11 && day <= 15))) {
                    return 'ÁßãÁπÅÊúü';
                } else {
                    return 'Ë∂äÂÜ¨Êúü';
                }
            }

            initializeSystem() {
                // Ë®≠ÂÆö‰ªäÊó•Êó•Êúü
                document.getElementById('recordDate').value = new Date().toISOString().split('T')[0];
                
                // Êõ¥Êñ∞Áï∂ÂâçÂ≠£ÁØÄÈ°ØÁ§∫
                document.getElementById('currentSeason').textContent = this.currentSeason;
                
                // ÂàùÂßãÂåñÁ§∫ÁØÑÊôÇÈñìËª∏
                this.initializeTimeline();
            }

            setupEventListeners() {
                const voiceBtn = document.getElementById('voiceBtn');
                voiceBtn.addEventListener('click', () => this.toggleRecording());
            }

            toggleRecording() {
                const voiceBtn = document.getElementById('voiceBtn');
                const voiceText = document.getElementById('voiceText');
                
                if (!this.isRecording) {
                    // ÈñãÂßãÈåÑÈü≥
                    this.isRecording = true;
                    voiceBtn.classList.add('recording');
                    voiceBtn.textContent = '‚èπÔ∏è';
                    voiceText.classList.add('listening');
                    voiceText.textContent = 'üé§ Ê≠£Âú®ÈåÑÈü≥‰∏≠...';
                    
                    // Ê®°Êì¨ÈåÑÈü≥ÈÅéÁ®ã
                    setTimeout(() => {
                        this.stopRecording();
                    }, 3000);
                } else {
                    this.stopRecording();
                }
            }

            stopRecording() {
                const voiceBtn = document.getElementById('voiceBtn');
                const voiceText = document.getElementById('voiceText');
                
                this.isRecording = false;
                voiceBtn.classList.remove('recording');
                voiceBtn.textContent = 'üé§';
                voiceText.classList.remove('listening');
                
                // Ê®°Êì¨Ë™ûÈü≥ËôïÁêÜ
                voiceText.textContent = 'üîÑ Ê≠£Âú®ËôïÁêÜË™ûÈü≥...';
                
                setTimeout(() => {
                    const sampleText = '‰ªäÂ§©AÂçÄÈ§µÁ≥ñÊ∞¥ÔºåÁî®‰∫Ü500ÊØ´ÂçáÁöÑÁ≥ñÊ∞¥ÔºåÂ§©Ê∞£Êô¥ÊúóÔºåÁâõËßíÁìúÈñãËä±ÊÉÖÊ≥Å‰∏≠Á≠â';
                    this.processVoiceInput(sampleText);
                }, 2000);
            }

            processVoiceInput(transcript) {
                const voiceText = document.getElementById('voiceText');
                voiceText.textContent = `üìù "${transcript}"`;
                
                // Êô∫ÊÖßËß£ÊûêË™ûÈü≥ÂÖßÂÆπ
                const parsedData = this.parseVoiceContent(transcript);
                
                // Ëá™ÂãïÂ°´ÂØ´Ë°®ÂñÆ
                this.fillForm(parsedData);
                
                // È°ØÁ§∫ÊàêÂäüÈÄöÁü•
                this.showNotification('‚úÖ Ë™ûÈü≥Ë®òÈåÑÂ∑≤ÊàêÂäüËß£Êûê‰∏¶Â°´ÂÖ•Ë°®ÂñÆÔºÅ', 'success');
            }

            parseVoiceContent(text) {
                const parsedData = {};
                
                // Ëß£ÊûêÂ§©Ê∞£
                if (text.includes('Êô¥') || text.includes('Â•ΩÂ§©Ê∞£')) {
                    parsedData.weather = 'Êô¥';
                } else if (text.includes('Èõ®')) {
                    parsedData.weather = 'Èõ®';
                } else if (text.includes('Èô∞')) {
                    parsedData.weather = 'Èô∞';
                } else if (text.includes('Â§öÈõ≤')) {
                    parsedData.weather = 'Â§öÈõ≤';
                }
                
                // Ëß£ÊûêÂçÄÂüü
                const areaMatch = text.match(/([ABC]ÂçÄ|\d+Ëôü)/);
                if (areaMatch) {
                    parsedData.location = areaMatch[0];
                }
                
                // Ëß£Êûê‰ΩúÊ•≠È†ÖÁõÆ
                if (text.includes('È§µÁ≥ñÊ∞¥') || text.includes('È§µÈ£ü')) {
                    parsedData.task = 'È§µÁ≥ñÊ∞¥';
                } else if (text.includes('ÂàÜËúÇ')) {
                    parsedData.task = 'ÂàÜËúÇ';
                } else if (text.includes('Êé°Ëúú') || text.includes('Êé°Êî∂')) {
                    parsedData.task = 'Êé°Êî∂';
                } else if (text.includes('Ê™¢Êü•') || text.includes('ÊèêËÑæ')) {
                    parsedData.task = 'ÊèêËÑæÊ™¢Êü•';
                }
                
                // Ëß£ÊûêÁâõËßíÁìúÈñãËä±ÊÉÖÊ≥Å
                if (text.includes('ÁõõÈñã') || text.includes('ÂæàÂ§ö') || text.includes('Â§ßÈáè')) {
                    parsedData.flowering = 'Â§ßÈáè';
                } else if (text.includes('‰∏≠Á≠â') || text.includes('ÊôÆÈÄö')) {
                    parsedData.flowering = '‰∏≠Á≠â';
                } else if (text.includes('Â∞ëÈáè') || text.includes('‰∏ÄÈªû')) {
                    parsedData.flowering = 'Â∞ëÈáè';
                }
                
                // Ëß£ÊûêÊé°Ëä±Ë∑°Ë±°
                if (text.includes('Êé°Ëä±') || text.includes('Á©çÊ•µ')) {
                    parsedData.foraging = 'ÊòØ';
                }
                
                // Ëß£ÊûêË≥áÊùêÂíåÁî®Èáè
                const sugarMatch = text.match(/Á≥ñÊ∞¥.*?(\d+).*?(ÊØ´Âçá|ml|ÂÖ¨Âçá|L)/i);
                if (sugarMatch) {
                    parsedData.material = 'Á≥ñÊ∞¥';
                    parsedData.quantity = f"{sugarMatch[1]}{sugarMatch[2]}";
                }
                
                // Ëß£ÊûêÊé°Êî∂Èáè
                const harvestMatch = text.match(/(\d+\.?\d*)\s*(ÂÖ¨Êñ§|kg)/i);
                if (harvestMatch) {
                    parsedData.harvest = float(harvestMatch[1]);
                }
                
                // ÂÇôË®ªÂ∞±ÊòØÂéüÂßãË™ûÈü≥ÂÖßÂÆπ
                parsedData.notes = text;
                
                return parsedData;
            }

            fillForm(data) {
                Object.entries(data).forEach(([key, value]) => {
                    const element = document.getElementById(key);
                    if (element && value) {
                        element.value = value;
                        element.classList.add('auto-filled');
                        setTimeout(() => element.classList.remove('auto-filled'), 3000);
                    }
                });
            }

            saveRecord() {
                const record = {
                    id: Date.now(),
                    recordDate: document.getElementById('recordDate').value,
                    farmName: document.getElementById('farmName').value,
                    producerName: document.getElementById('producerName').value,
                    weather: document.getElementById('weather').value,
                    location: document.getElementById('location').value,
                    task: document.getElementById('task').value,
                    flowering: document.getElementById('flowering').value,
                    foraging: document.getElementById('foraging').value,
                    material: document.getElementById('material').value,
                    quantity: document.getElementById('quantity').value,
                    harvest: parseFloat(document.getElementById('harvest').value || 0),
                    notes: document.getElementById('notes').value,
                    createdAt: new Date().toISOString()
                };

                if (!record.recordDate || !record.task) {
                    this.showNotification('‚ùå Ë´ãÂ°´ÂØ´Ë®òÈåÑÊó•ÊúüÂíå‰ΩúÊ•≠È†ÖÁõÆ', 'error');
                    return;
                }

                this.records.push(record);
                localStorage.setItem('beekeepingRecords', JSON.stringify(this.records));

                this.updateTimeline();
                this.updateStats();

                this.showNotification('‚úÖ Ë®òÈåÑÂ∑≤ÊàêÂäüÂÑ≤Â≠òÔºÅ', 'success');

                this.sendToBackend(record);
            }

            sendToBackend(record) {
                console.log('ÁôºÈÄÅË®òÈåÑÂà∞ÂæåÁ´ØÁ≥ªÁµ±:', record);
                setTimeout(() => {
                    this.showNotification('üì§ Ë≥áÊñôÂ∑≤ÂêåÊ≠•Âà∞GAPÁÆ°ÁêÜÁ≥ªÁµ±', 'success');
                }, 1000);
            }

            clearForm() {
                document.querySelectorAll('.form-input').forEach(input => {
                    if (input.id !== 'recordDate' && input.id !== 'farmName' && input.id !== 'producerName') {
                        input.value = '';
                    }
                });

                this.showNotification('üóëÔ∏è Ë°®ÂñÆÂ∑≤Ê∏ÖÁ©∫', 'success');
            }

            loadData() {
                this.updateTimeline();
                this.updateStats();
            }

            updateTimeline() {
                const timeline = document.getElementById('timeline');
                timeline.innerHTML = '';
                const recentRecords = this.records.slice(-10).reverse();
                recentRecords.forEach(record => {
                    const timelineItem = document.createElement('div');
                    timelineItem.className = 'timeline-item';
                    const date = new Date(record.recordDate).toLocaleDateString('zh-TW');
                    const time = new Date(record.createdAt).toLocaleTimeString('zh-TW', {hour: '2-digit', minute: '2-digit'});
                    timelineItem.innerHTML = `
                        <div class="timeline-date">${date} ${time}</div>
                        <div class="timeline-task">${this.getTaskIcon(record.task)} ${record.task}</div>
                        <div class="timeline-details">
                            ${record.location ? `üìç ${record.location}` : ''}
                            ${record.weather ? `üå§Ô∏è ${record.weather}` : ''}
                            ${record.flowering ? `üå∫ ÁâõËßíÁìú: ${record.flowering}` : ''}
                            ${record.harvest > 0 ? `üçØ Êé°Êî∂: ${record.harvest}kg` : ''}
                            ${record.material ? `üß™ ${record.material} ${record.quantity || ''}` : ''}
                        </div>
                        ${record.notes ? `<div class="timeline-details" style="margin-top: 10px; font-style: italic;">"${record.notes}"</div>` : ''}
                    `;
                    timeline.appendChild(timelineItem);
                });
                if (recentRecords.length === 0) {
                    this.initializeTimeline();
                }
            }

            initializeTimeline() {
                const timeline = document.getElementById('timeline');
                const sampleRecords = [
                    {date: '2025-01-27', time: '08:30', task: 'È§µÁ≥ñÊ∞¥', icon: 'üçØ', details: 'üìç AÂçÄ üå§Ô∏è Êô¥ üß™ Á≥ñÊ∞¥ 500ml', notes: 'Êò•ÁπÅÊúüÈñãÂßãÔºåËúÇÁæ§Ê¥ªÂãïÂ¢ûÂä†'},
                    {date: '2025-01-26', time: '15:20', task: 'ÊèêËÑæÊ™¢Êü•', icon: 'üîç', details: 'üìç BÂçÄ üå∫ ÁâõËßíÁìú: ‰∏≠Á≠â', notes: 'ÁôºÁèæÊñ∞ÁöÑÁéãÂè∞ÔºåÊ∫ñÂÇôÂàÜËúÇ'},
                    {date: '2025-01-25', time: '09:15', task: 'Êé°Êî∂', icon: 'üçØ', details: 'üìç CÂçÄ üçØ Êé°Êî∂: 12.5kg üå∫ ÁâõËßíÁìú: Â§ßÈáè', notes: 'ÁâõËßíÁìúËúúÊ∫êÂìÅË≥™ÂÑ™ËâØ'},
                    {date: '2025-01-24', time: '07:45', task: 'ÂàÜËúÇ', icon: 'üëë', details: 'üìç AÂçÄ üå§Ô∏è Â§öÈõ≤', notes: 'Á¨¨8Â§©Ê™¢Êü•Ôºå5ÂÄãÁéãÂè∞ÁôºËÇ≤ËâØÂ•Ω'}
                ];
                timeline.innerHTML = '';
                sampleRecords.forEach(record => {
                    const timelineItem = document.createElement('div');
                    timelineItem.className = 'timeline-item';
                    timelineItem.innerHTML = `
                        <div class="timeline-date">${record.date} ${record.time}</div>
                        <div class="timeline-task">${record.icon} ${record.task}</div>
                        <div class="timeline-details">${record.details}</div>
                        <div class="timeline-details" style="margin-top: 10px; font-style: italic;">"${record.notes}"</div>
                    `;
                    timeline.appendChild(timelineItem);
                });
            }

            updateStats() {
                document.getElementById('totalRecords').textContent = this.records.length;
                const totalHoney = this.records.reduce((sum, r) => sum + (r.harvest || 0), 0);
                document.getElementById('totalHoney').textContent = totalHoney.toFixed(1);
                const areas = new Set(this.records.map(r => r.location).filter(Boolean));
                document.getElementById('activeAreas').textContent = areas.size;
            }

            getTaskIcon(task) {
                const icons = {
                    'È§µÁ≥ñÊ∞¥': 'üçØ',
                    'ÂàÜËúÇ': 'üëë',
                    'ËÇ≤Áéã': 'üë∏',
                    'ÊèêËÑæÊ™¢Êü•': 'üîç',
                    'Êé°Êî∂': 'üçØ',
                    'Ê∏ÖÁêÜ': 'üßπ',
                    'Èò≤Ê≤ª': 'üíä',
                    'ÁßªÁÆ±': 'üì¶'
                };
                return icons[task] || '‚ö°';
            }

            showNotification(message, type = 'success') {
                const notification = document.getElementById('notification');
                notification.textContent = message;
                notification.className = `notification ${type}`;
                notification.classList.add('show');
                setTimeout(() => notification.classList.remove('show'), 3000);
            }

            simulateVoiceInput(type) {
                const voiceText = document.getElementById('voiceText');
                const sampleInputs = {
                    'Êò•ÁπÅ': '‰ªäÂ§©AÂçÄÈñãÂßãÊò•ÁπÅÔºåÈ§µ‰∫ÜÁ≥ñÊ∞¥500ÊØ´ÂçáÔºåÂ§©Ê∞£Êô¥ÊúóÔºåËúÇÁæ§Ê¥ªÂãïÂ¢ûÂä†',
                    'ÂàÜËúÇ': 'Á¨¨ÂÖ´Â§©Ê™¢Êü•ËÇ≤ÁéãÁæ§ÔºåBÂçÄÊúâ‰∫îÂÄãÁéãÂè∞ÁôºËÇ≤ËâØÂ•ΩÔºåÂ§©Ê∞£Â§öÈõ≤ÔºåÊ∫ñÂÇôÂàÜËúÇ',
                    'Êé°Ëúú': '‰ªäÂ§©CÂçÄÊé°Êî∂ËúÇËúú15ÂÖ¨Êñ§ÔºåÁâõËßíÁìúÈñãËä±Â§ßÈáèÔºåËúúËúÇÊé°Ëä±ÂæàÁ©çÊ•µÔºåÂìÅË≥™ÂæàÂ•Ω'
                };
                const transcript = sampleInputs[type];
                voiceText.textContent = 'üîÑ Ê≠£Âú®ËôïÁêÜË™ûÈü≥...';
                setTimeout(() => this.processVoiceInput(transcript), 1500);
            }
        }

        function simulateVoiceInput(type) { window.beekeepingSystem.simulateVoiceInput(type); }
        function saveRecord() { window.beekeepingSystem.saveRecord(); }
        function clearForm() { window.beekeepingSystem.clearForm(); }

        document.addEventListener('DOMContentLoaded', function() {
            window.beekeepingSystem = new BeekeepingVoiceSystem();
            showDailyReminder();
        });

        function showDailyReminder() {
            const now = new Date();
            const hour = now.getHours();
            if (hour === 7) {
                const currentSeason = window.beekeepingSystem.currentSeason;
                const seasonTasks = {
                    'Êò•ÁπÅÊúü': ['È§µÁ≥ñÊ∞¥', 'ËúÇÁÆ±Ê∏ÖÁêÜ', 'Ê™¢Êü•ËúÇÁæ§Âº∑Â∫¶'],
                    'ÂàÜËúÇÊúü': ['‰∫∫Â∑•ËÇ≤Áéã', 'ÂàÜËúÇÁÆ°ÁêÜ', 'Êñ∞ÁéãÂüπËÇ≤'],
                    'Êé°ËúúÊúü': ['ËúúÊ∫êÁÆ°ÁêÜ', 'ÁâõËßíÁìúÁõ£Ê∏¨', 'Êé°Êî∂‰ΩúÊ•≠'],
                    'ÁßãÁπÅÊúü': ['ÁßãÂ≠£ÁπÅÊÆñ', 'ÂÑ≤ÂÇôË∂äÂÜ¨', 'ËúÇÁæ§Êï¥‰Ωµ'],
                    'Ë∂äÂÜ¨Êúü': ['‰øùÊ∫´', 'Ê∏õÂ∞ëÂπ≤Êìæ', 'Áõ£Ê∏¨Â≠òÊ¥ª']
                };
                const tasks = seasonTasks[currentSeason] || [];
                const message = `üêù ‰ªäÊó•ËúÇÂ†¥‰ªªÂãô
üå∏ ${currentSeason}
‚ö° ${tasks.join('„ÄÅ')}`;
                setTimeout(() => { alert(message); }, 2000);
            }
        }

        document.addEventListener('keydown', function(e) {
            if (e.code === 'Space' && e.target.tagName !== 'INPUT' && e.target.tagName !== 'TEXTAREA') {
                e.preventDefault();
                window.beekeepingSystem.toggleRecording();
            }
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                saveRecord();
            }
            if (e.ctrlKey && e.key === 'r') {
                e.preventDefault();
                clearForm();
            }
        });

        if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            const recognition = new SpeechRecognition();
            recognition.lang = 'zh-TW';
            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.onresult = function(event) {
                const transcript = event.results[0][0].transcript;
                window.beekeepingSystem.processVoiceInput(transcript);
            };
            recognition.onerror = function(event) {
                console.error('Ë™ûÈü≥Ë≠òÂà•ÈåØË™§:', event.error);
                window.beekeepingSystem.showNotification('‚ùå Ë™ûÈü≥Ë≠òÂà•Â§±ÊïóÔºåË´ãÈáçË©¶', 'error');
            };
            window.beekeepingSystem.toggleRecording = function() {
                if (!this.isRecording) {
                    this.isRecording = true;
                    const voiceBtn = document.getElementById('voiceBtn');
                    const voiceText = document.getElementById('voiceText');
                    voiceBtn.classList.add('recording');
                    voiceBtn.textContent = '‚èπÔ∏è';
                    voiceText.classList.add('listening');
                    voiceText.textContent = 'üé§ Ë´ãÈñãÂßãË™™Ë©±...';
                    recognition.start();
                } else {
                    recognition.stop();
                    this.stopRecording();
                }
            };
            recognition.onend = function() { window.beekeepingSystem.stopRecording(); };
        }

        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js').then(function(r) { console.log('ServiceWorker Ë®ªÂÜäÊàêÂäü'); }).catch(function() { console.log('ServiceWorker Ë®ªÂÜäÂ§±Êïó'); });
            });
        }

        window.addEventListener('online', function() { window.beekeepingSystem.showNotification('üåê Á∂≤Ë∑ØÂ∑≤ÈÄ£Á∑öÔºåÊ≠£Âú®ÂêåÊ≠•Ë≥áÊñô...', 'success'); });
        window.addEventListener('offline', function() { window.beekeepingSystem.showNotification('üì± ÁõÆÂâçÈõ¢Á∑öÊ®°ÂºèÔºåË≥áÊñôÂ∞áÂú®ÈÄ£Á∑öÂæåÂêåÊ≠•', 'warning'); });
    </script>
</body>
</html>
