
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ ç‰›è§’ç“œèœ‚å ´èªéŸ³ç®¡ç†ç³»çµ±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Taisho Gothic, 'å¾®è»Ÿæ­£é»‘é«”', sans-serif;
            background: linear-gradient(135deg, #FFA500 0%, #FF6B35 50%, #FF8C00 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #FF8C00 0%, #FF6B35 100%);
            color: white;
            padding: 40px;
            text-align: center;
            position: relative;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="10" cy="10" r="2" fill="rgba(255,255,255,0.1)"/><circle cx="30" cy="25" r="1.5" fill="rgba(255,255,255,0.1)"/><circle cx="60" cy="15" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="80" cy="30" r="2.5" fill="rgba(255,255,255,0.1)"/></svg>');
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .main-content {
            padding: 40px;
        }

        .demo-section {
            margin-bottom: 40px;
        }

        .section-title {
            font-size: 1.8rem;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .voice-demo {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .voice-demo::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, #FF8C00, #FF6B35, #4CAF50);
        }

        .voice-input {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .voice-button {
            background: linear-gradient(135deg, #FF6B35, #FF8C00);
            color: white;
            border: none;
            border-radius: 50%;
            width: 80px;
            height: 80px;
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
        }

        .voice-button:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(255, 107, 53, 0.4);
        }

        .voice-button.recording {
            animation: pulse 1.5s infinite;
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .voice-text {
            flex: 1;
            background: white;
            border: 2px solid #eee;
            border-radius: 10px;
            padding: 15px;
            font-size: 1.1rem;
            min-height: 60px;
            display: flex;
            align-items: center;
        }

        .voice-text.listening {
            border-color: #FF6B35;
            box-shadow: 0 0 10px rgba(255, 107, 53, 0.2);
        }

        .gap-form {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            margin-top: 20px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }

        .form-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #eee;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #FF6B35;
            box-shadow: 0 0 5px rgba(255, 107, 53, 0.2);
        }

        .form-input.auto-filled {
            background: #e8f5e8;
            border-color: #4CAF50;
        }

        .timeline-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
        }

        .timeline {
            position: relative;
            padding-left: 30px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 15px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(to bottom, #FF8C00, #FF6B35, #4CAF50);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -37px;
            top: 20px;
            width: 12px;
            height: 12px;
            background: #FF6B35;
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 0 0 2px #FF6B35;
        }

        .timeline-date {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 5px;
        }

        .timeline-task {
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
        }

        .timeline-details {
            color: #666;
            font-size: 0.95rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #FF6B35;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 0.9rem;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #FF6B35, #FF8C00);
            color: white;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4CAF50;
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            background: #e74c3c;
        }

        .notification.warning {
            background: #f39c12;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .voice-input {
                flex-direction: column;
                text-align: center;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ ç‰›è§’ç“œèœ‚å ´èªéŸ³ç®¡ç†ç³»çµ±</h1>
            <p>æ™ºæ…§èªéŸ³è¨˜éŒ„ Ã— GAPèªè­‰ç®¡ç† Ã— å°ˆæ¥­èœ‚å ´ç³»çµ±</p>
        </div>

        <div class="main-content">
            <!-- èªéŸ³è¼¸å…¥å€åŸŸ -->
            <div class="demo-section">
                <h2 class="section-title">
                    ğŸ¤ èªéŸ³è¨˜éŒ„å€åŸŸ
                </h2>
                
                <div class="voice-demo">
                    <div class="voice-input">
                        <button class="voice-button" id="voiceBtn">ğŸ¤</button>
                        <div class="voice-text" id="voiceText">
                            é»æ“Šéº¥å…‹é¢¨é–‹å§‹èªéŸ³è¨˜éŒ„...
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="simulateVoiceInput('æ˜¥ç¹')">
                            ğŸŒ¸ æ¨¡æ“¬æ˜¥ç¹è¨˜éŒ„
                        </button>
                        <button class="btn btn-primary" onclick="simulateVoiceInput('åˆ†èœ‚')">
                            ğŸ‘‘ æ¨¡æ“¬åˆ†èœ‚è¨˜éŒ„
                        </button>
                        <button class="btn btn-primary" onclick="simulateVoiceInput('æ¡èœœ')">
                            ğŸ¯ æ¨¡æ“¬æ¡èœœè¨˜éŒ„
                        </button>
                    </div>
                </div>
            </div>

            <!-- GAPè¡¨å–®å€åŸŸ -->
            <div class="demo-section">
                <h2 class="section-title">
                    ğŸ“‹ GAP èªè­‰è¡¨å–®
                </h2>
                
                <div class="gap-form">
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">è¨˜éŒ„æ—¥æœŸ</label>
                            <input type="date" class="form-input" id="recordDate" />
                        </div>
                        <div class="form-group">
                            <label class="form-label">è¾²å ´åç¨±</label>
                            <input type="text" class="form-input" id="farmName" value="è¨±èƒ½åŸèœ‚å ´" />
                        </div>
                        <div class="form-group">
                            <label class="form-label">ç”Ÿç”¢è€…å§“å</label>
                            <input type="text" class="form-input" id="producerName" value="è¨±èƒ½åŸ" />
                        </div>
                        <div class="form-group">
                            <label class="form-label">å¤©æ°£ç‹€æ³</label>
                            <select class="form-input" id="weather">
                                <option value="">è«‹é¸æ“‡</option>
                                <option value="æ™´">â˜€ï¸ æ™´</option>
                                <option value="é›¨">ğŸŒ§ï¸ é›¨</option>
                                <option value="é™°">â˜ï¸ é™°</option>
                                <option value="å¤šé›²">â›… å¤šé›²</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">èœ‚å ´ä½ç½®èˆ‡ç·¨è™Ÿ</label>
                            <input type="text" class="form-input" id="location" />
                        </div>
                        <div class="form-group">
                            <label class="form-label">ä½œæ¥­é …ç›®</label>
                            <input type="text" class="form-input" id="task" />
                        </div>
                        <div class="form-group">
                            <label class="form-label">ç‰›è§’ç“œé–‹èŠ±æƒ…æ³</label>
                            <select class="form-input" id="flowering">
                                <option value="">è«‹é¸æ“‡</option>
                                <option value="ç„¡">ç„¡</option>
                                <option value="å°‘é‡">ğŸŒ¸ å°‘é‡</option>
                                <option value="ä¸­ç­‰">ğŸŒº ä¸­ç­‰</option>
                                <option value="å¤§é‡">ğŸŒ» å¤§é‡</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">æ¡èŠ±è·¡è±¡</label>
                            <select class="form-input" id="foraging">
                                <option value="">è«‹é¸æ“‡</option>
                                <option value="æ˜¯">âœ… æ˜¯</option>
                                <option value="å¦">âŒ å¦</option>
                                <option value="ä¸ç¢ºå®š">â“ ä¸ç¢ºå®š</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">è³‡æåç¨±</label>
                            <input type="text" class="form-input" id="material" />
                        </div>
                        <div class="form-group">
                            <label class="form-label">ä½¿ç”¨é‡</label>
                            <input type="text" class="form-input" id="quantity" />
                        </div>
                        <div class="form-group">
                            <label class="form-label">æ¡æ”¶é‡ (kg)</label>
                            <input type="number" class="form-input" id="harvest" step="0.1" />
                        </div>
                        <div class="form-group">
                            <label class="form-label">å‚™è¨»</label>
                            <textarea class="form-input" id="notes" rows="3"></textarea>
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn btn-success" onclick="saveRecord()">
                            ğŸ’¾ å„²å­˜è¨˜éŒ„
                        </button>
                        <button class="btn btn-secondary" onclick="clearForm()">
                            ğŸ—‘ï¸ æ¸…ç©ºè¡¨å–®
                        </button>
                    </div>
                </div>
            </div>

            <!-- èœ‚å ´ç®¡ç†æ™‚é–“è»¸ -->
            <div class="demo-section">
                <h2 class="section-title">
                    ğŸ“… èœ‚å ´ç®¡ç†æ™‚é–“è»¸
                </h2>
                
                <div class="timeline-section">
                    <div class="timeline" id="timeline">
                        <!-- æ™‚é–“è»¸é …ç›®å°‡ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
                    </div>
                </div>
            </div>

            <!-- çµ±è¨ˆè³‡è¨Š -->
            <div class="demo-section">
                <h2 class="section-title">
                    ğŸ“Š èœ‚å ´çµ±è¨ˆè³‡è¨Š
                </h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">ğŸ“</div>
                        <div class="stat-number" id="totalRecords">0</div>
                        <div class="stat-label">ç¸½è¨˜éŒ„æ•¸</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">ğŸ¯</div>
                        <div class="stat-number" id="totalHoney">0</div>
                        <div class="stat-label">ç¸½æ¡æ”¶é‡ (kg)</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">ğŸ </div>
                        <div class="stat-number" id="activeAreas">0</div>
                        <div class="stat-label">æ´»èºå€åŸŸ</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">ğŸŒ¸</div>
                        <div class="stat-number" id="currentSeason">æ˜¥ç¹æœŸ</div>
                        <div class="stat-label">ç•¶å‰å­£ç¯€</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- é€šçŸ¥è¨Šæ¯ -->
    <div class="notification" id="notification"></div>

    <script>
        // èœ‚å ´ç®¡ç†ç³»çµ± JavaScript
        class BeekeepingVoiceSystem {
            constructor() {
                this.isRecording = false;
                this.records = JSON.parse(localStorage.getItem('beekeepingRecords') || '[]');
                this.currentSeason = this.getCurrentSeason();
                
                this.initializeSystem();
                this.setupEventListeners();
                this.loadData();
            }

            getCurrentSeason() {
                const now = new Date();
                const month = now.getMonth() + 1;
                const day = now.getDate();
                
                if ((month === 1 && day >= 20) || (month === 2) || (month === 3 && day <= 20)) {
                    return 'æ˜¥ç¹æœŸ';
                } else if ((month === 3 && day >= 21) || (month === 4) || (month === 5 && day <= 15)) {
                    return 'åˆ†èœ‚æœŸ';
                } else if ((month === 5 && day >= 16) || month <= 8) {
                    return 'æ¡èœœæœŸ';
                } else if (month >= 9 && (month < 11 || (month === 11 && day <= 15))) {
                    return 'ç§‹ç¹æœŸ';
                } else {
                    return 'è¶Šå†¬æœŸ';
                }
            }

            initializeSystem() {
                // è¨­å®šä»Šæ—¥æ—¥æœŸ
                document.getElementById('recordDate').value = new Date().toISOString().split('T')[0];
                
                // æ›´æ–°ç•¶å‰å­£ç¯€é¡¯ç¤º
                document.getElementById('currentSeason').textContent = this.currentSeason;
                
                // åˆå§‹åŒ–ç¤ºç¯„æ™‚é–“è»¸
                this.initializeTimeline();
            }

            setupEventListeners() {
                const voiceBtn = document.getElementById('voiceBtn');
                voiceBtn.addEventListener('click', () => this.toggleRecording());
            }

            toggleRecording() {
                const voiceBtn = document.getElementById('voiceBtn');
                const voiceText = document.getElementById('voiceText');
                
                if (!this.isRecording) {
                    // é–‹å§‹éŒ„éŸ³
                    this.isRecording = true;
                    voiceBtn.classList.add('recording');
                    voiceBtn.textContent = 'â¹ï¸';
                    voiceText.classList.add('listening');
                    voiceText.textContent = 'ğŸ¤ æ­£åœ¨éŒ„éŸ³ä¸­...';
                    
                    // æ¨¡æ“¬éŒ„éŸ³éç¨‹
                    setTimeout(() => {
                        this.stopRecording();
                    }, 3000);
                } else {
                    this.stopRecording();
                }
            }

            stopRecording() {
                const voiceBtn = document.getElementById('voiceBtn');
                const voiceText = document.getElementById('voiceText');
                
                this.isRecording = false;
                voiceBtn.classList.remove('recording');
                voiceBtn.textContent = 'ğŸ¤';
                voiceText.classList.remove('listening');
                
                // æ¨¡æ“¬èªéŸ³è™•ç†
                voiceText.textContent = 'ğŸ”„ æ­£åœ¨è™•ç†èªéŸ³...';
                
                setTimeout(() => {
                    const sampleText = 'ä»Šå¤©Aå€é¤µç³–æ°´ï¼Œç”¨äº†500æ¯«å‡çš„ç³–æ°´ï¼Œå¤©æ°£æ™´æœ—ï¼Œç‰›è§’ç“œé–‹èŠ±æƒ…æ³ä¸­ç­‰';
                    this.processVoiceInput(sampleText);
                }, 2000);
            }

            processVoiceInput(transcript) {
                const voiceText = document.getElementById('voiceText');
                voiceText.textContent = `ğŸ“ "${transcript}"`;
                
                // æ™ºæ…§è§£æèªéŸ³å…§å®¹
                const parsedData = this.parseVoiceContent(transcript);
                
                // è‡ªå‹•å¡«å¯«è¡¨å–®
                this.fillForm(parsedData);
                
                // é¡¯ç¤ºæˆåŠŸé€šçŸ¥
                this.showNotification('âœ… èªéŸ³è¨˜éŒ„å·²æˆåŠŸè§£æä¸¦å¡«å…¥è¡¨å–®ï¼', 'success');
            }

            parseVoiceContent(text) {
                const parsedData = {};
                
                // è§£æå¤©æ°£
                if (text.includes('æ™´') || text.includes('å¥½å¤©æ°£')) {
                    parsedData.weather = 'æ™´';
                } else if (text.includes('é›¨')) {
                    parsedData.weather = 'é›¨';
                } else if (text.includes('é™°')) {
                    parsedData.weather = 'é™°';
                } else if (text.includes('å¤šé›²')) {
                    parsedData.weather = 'å¤šé›²';
                }
                
                // è§£æå€åŸŸ
                const areaMatch = text.match(/([ABC]å€|\d+è™Ÿ)/);
                if (areaMatch) {
                    parsedData.location = areaMatch[0];
                }
                
                // è§£æä½œæ¥­é …ç›®
                if (text.includes('é¤µç³–æ°´') || text.includes('é¤µé£Ÿ')) {
                    parsedData.task = 'é¤µç³–æ°´';
                } else if (text.includes('åˆ†èœ‚')) {
                    parsedData.task = 'åˆ†èœ‚';
                } else if (text.includes('æ¡èœœ') || text.includes('æ¡æ”¶')) {
                    parsedData.task = 'æ¡æ”¶';
                } else if (text.includes('æª¢æŸ¥') || text.includes('æè„¾')) {
                    parsedData.task = 'æè„¾æª¢æŸ¥';
                }
                
                // è§£æç‰›è§’ç“œé–‹èŠ±æƒ…æ³
                if (text.includes('ç››é–‹') || text.includes('å¾ˆå¤š') || text.includes('å¤§é‡')) {
                    parsedData.flowering = 'å¤§é‡';
                } else if (text.includes('ä¸­ç­‰') || text.includes('æ™®é€š')) {
                    parsedData.flowering = 'ä¸­ç­‰';
                } else if (text.includes('å°‘é‡') || text.includes('ä¸€é»')) {
                    parsedData.flowering = 'å°‘é‡';
                }
                
                // è§£ææ¡èŠ±è·¡è±¡
                if (text.includes('æ¡èŠ±') || text.includes('ç©æ¥µ')) {
                    parsedData.foraging = 'æ˜¯';
                }
                
                // è§£æè³‡æå’Œç”¨é‡
                const sugarMatch = text.match(/ç³–æ°´.*?(\d+).*?(æ¯«å‡|ml|å…¬å‡|L)/i);
                if (sugarMatch) {
                    parsedData.material = 'ç³–æ°´';
                    parsedData.quantity = f"{sugarMatch[1]}{sugarMatch[2]}";
                }
                
                // è§£ææ¡æ”¶é‡
                const harvestMatch = text.match(/(\d+\.?\d*)\s*(å…¬æ–¤|kg)/i);
                if (harvestMatch) {
                    parsedData.harvest = float(harvestMatch[1]);
                }
                
                // å‚™è¨»å°±æ˜¯åŸå§‹èªéŸ³å…§å®¹
                parsedData.notes = text;
                
                return parsedData;
            }

            fillForm(data) {
                Object.entries(data).forEach(([key, value]) => {
                    const element = document.getElementById(key);
                    if (element && value) {
                        element.value = value;
                        element.classList.add('auto-filled');
                        setTimeout(() => element.classList.remove('auto-filled'), 3000);
                    }
                });
            }

            saveRecord() {
                const record = {
                    id: Date.now(),
                    recordDate: document.getElementById('recordDate').value,
                    farmName: document.getElementById('farmName').value,
                    producerName: document.getElementById('producerName').value,
                    weather: document.getElementById('weather').value,
                    location: document.getElementById('location').value,
                    task: document.getElementById('task').value,
                    flowering: document.getElementById('flowering').value,
                    foraging: document.getElementById('foraging').value,
                    material: document.getElementById('material').value,
                    quantity: document.getElementById('quantity').value,
                    harvest: parseFloat(document.getElementById('harvest').value || 0),
                    notes: document.getElementById('notes').value,
                    createdAt: new Date().toISOString()
                };

                if (!record.recordDate || !record.task) {
                    this.showNotification('âŒ è«‹å¡«å¯«è¨˜éŒ„æ—¥æœŸå’Œä½œæ¥­é …ç›®', 'error');
                    return;
                }

                this.records.push(record);
                localStorage.setItem('beekeepingRecords', JSON.stringify(this.records));

                this.updateTimeline();
                this.updateStats();

                this.showNotification('âœ… è¨˜éŒ„å·²æˆåŠŸå„²å­˜ï¼', 'success');

                this.sendToBackend(record);
            }

            sendToBackend(record) {
                console.log('ç™¼é€è¨˜éŒ„åˆ°å¾Œç«¯ç³»çµ±:', record);
                setTimeout(() => {
                    this.showNotification('ğŸ“¤ è³‡æ–™å·²åŒæ­¥åˆ°GAPç®¡ç†ç³»çµ±', 'success');
                }, 1000);
            }

            clearForm() {
                document.querySelectorAll('.form-input').forEach(input => {
                    if (input.id !== 'recordDate' && input.id !== 'farmName' && input.id !== 'producerName') {
                        input.value = '';
                    }
                });

                this.showNotification('ğŸ—‘ï¸ è¡¨å–®å·²æ¸…ç©º', 'success');
            }

            loadData() {
                this.updateTimeline();
                this.updateStats();
            }

            updateTimeline() {
                const timeline = document.getElementById('timeline');
                timeline.innerHTML = '';
                const recentRecords = this.records.slice(-10).reverse();
                recentRecords.forEach(record => {
                    const timelineItem = document.createElement('div');
                    timelineItem.className = 'timeline-item';
                    const date = new Date(record.recordDate).toLocaleDateString('zh-TW');
                    const time = new Date(record.createdAt).toLocaleTimeString('zh-TW', {hour: '2-digit', minute: '2-digit'});
                    timelineItem.innerHTML = `
                        <div class="timeline-date">${date} ${time}</div>
                        <div class="timeline-task">${this.getTaskIcon(record.task)} ${record.task}</div>
                        <div class="timeline-details">
                            ${record.location ? `ğŸ“ ${record.location}` : ''}
                            ${record.weather ? `ğŸŒ¤ï¸ ${record.weather}` : ''}
                            ${record.flowering ? `ğŸŒº ç‰›è§’ç“œ: ${record.flowering}` : ''}
                            ${record.harvest > 0 ? `ğŸ¯ æ¡æ”¶: ${record.harvest}kg` : ''}
                            ${record.material ? `ğŸ§ª ${record.material} ${record.quantity || ''}` : ''}
                        </div>
                        ${record.notes ? `<div class="timeline-details" style="margin-top: 10px; font-style: italic;">"${record.notes}"</div>` : ''}
                    `;
                    timeline.appendChild(timelineItem);
                });
                if (recentRecords.length === 0) {
                    this.initializeTimeline();
                }
            }

            initializeTimeline() {
                const timeline = document.getElementById('timeline');
                const sampleRecords = [
                    {date: '2025-01-27', time: '08:30', task: 'é¤µç³–æ°´', icon: 'ğŸ¯', details: 'ğŸ“ Aå€ ğŸŒ¤ï¸ æ™´ ğŸ§ª ç³–æ°´ 500ml', notes: 'æ˜¥ç¹æœŸé–‹å§‹ï¼Œèœ‚ç¾¤æ´»å‹•å¢åŠ '},
                    {date: '2025-01-26', time: '15:20', task: 'æè„¾æª¢æŸ¥', icon: 'ğŸ”', details: 'ğŸ“ Bå€ ğŸŒº ç‰›è§’ç“œ: ä¸­ç­‰', notes: 'ç™¼ç¾æ–°çš„ç‹å°ï¼Œæº–å‚™åˆ†èœ‚'},
                    {date: '2025-01-25', time: '09:15', task: 'æ¡æ”¶', icon: 'ğŸ¯', details: 'ğŸ“ Cå€ ğŸ¯ æ¡æ”¶: 12.5kg ğŸŒº ç‰›è§’ç“œ: å¤§é‡', notes: 'ç‰›è§’ç“œèœœæºå“è³ªå„ªè‰¯'},
                    {date: '2025-01-24', time: '07:45', task: 'åˆ†èœ‚', icon: 'ğŸ‘‘', details: 'ğŸ“ Aå€ ğŸŒ¤ï¸ å¤šé›²', notes: 'ç¬¬8å¤©æª¢æŸ¥ï¼Œ5å€‹ç‹å°ç™¼è‚²è‰¯å¥½'}
                ];
                timeline.innerHTML = '';
                sampleRecords.forEach(record => {
                    const timelineItem = document.createElement('div');
                    timelineItem.className = 'timeline-item';
                    timelineItem.innerHTML = `
                        <div class="timeline-date">${record.date} ${record.time}</div>
                        <div class="timeline-task">${record.icon} ${record.task}</div>
                        <div class="timeline-details">${record.details}</div>
                        <div class="timeline-details" style="margin-top: 10px; font-style: italic;">"${record.notes}"</div>
                    `;
                    timeline.appendChild(timelineItem);
                });
            }

            updateStats() {
                document.getElementById('totalRecords').textContent = this.records.length;
                const totalHoney = this.records.reduce((sum, r) => sum + (r.harvest || 0), 0);
                document.getElementById('totalHoney').textContent = totalHoney.toFixed(1);
                const areas = new Set(this.records.map(r => r.location).filter(Boolean));
                document.getElementById('activeAreas').textContent = areas.size;
            }

            getTaskIcon(task) {
                const icons = {
                    'é¤µç³–æ°´': 'ğŸ¯',
                    'åˆ†èœ‚': 'ğŸ‘‘',
                    'è‚²ç‹': 'ğŸ‘¸',
                    'æè„¾æª¢æŸ¥': 'ğŸ”',
                    'æ¡æ”¶': 'ğŸ¯',
                    'æ¸…ç†': 'ğŸ§¹',
                    'é˜²æ²»': 'ğŸ’Š',
                    'ç§»ç®±': 'ğŸ“¦'
                };
                return icons[task] || 'âš¡';
            }

            showNotification(message, type = 'success') {
                const notification = document.getElementById('notification');
                notification.textContent = message;
                notification.className = `notification ${type}`;
                notification.classList.add('show');
                setTimeout(() => notification.classList.remove('show'), 3000);
            }

            simulateVoiceInput(type) {
                const voiceText = document.getElementById('voiceText');
                const sampleInputs = {
                    'æ˜¥ç¹': 'ä»Šå¤©Aå€é–‹å§‹æ˜¥ç¹ï¼Œé¤µäº†ç³–æ°´500æ¯«å‡ï¼Œå¤©æ°£æ™´æœ—ï¼Œèœ‚ç¾¤æ´»å‹•å¢åŠ ',
                    'åˆ†èœ‚': 'ç¬¬å…«å¤©æª¢æŸ¥è‚²ç‹ç¾¤ï¼ŒBå€æœ‰äº”å€‹ç‹å°ç™¼è‚²è‰¯å¥½ï¼Œå¤©æ°£å¤šé›²ï¼Œæº–å‚™åˆ†èœ‚',
                    'æ¡èœœ': 'ä»Šå¤©Cå€æ¡æ”¶èœ‚èœœ15å…¬æ–¤ï¼Œç‰›è§’ç“œé–‹èŠ±å¤§é‡ï¼Œèœœèœ‚æ¡èŠ±å¾ˆç©æ¥µï¼Œå“è³ªå¾ˆå¥½'
                };
                const transcript = sampleInputs[type];
                voiceText.textContent = 'ğŸ”„ æ­£åœ¨è™•ç†èªéŸ³...';
                setTimeout(() => this.processVoiceInput(transcript), 1500);
            }
        }

        function simulateVoiceInput(type) { window.beekeepingSystem.simulateVoiceInput(type); }
        function saveRecord() { window.beekeepingSystem.saveRecord(); }
        function clearForm() { window.beekeepingSystem.clearForm(); }

        document.addEventListener('DOMContentLoaded', function() {
            window.beekeepingSystem = new BeekeepingVoiceSystem();
            showDailyReminder();
        });

        function showDailyReminder() {
            const now = new Date();
            const hour = now.getHours();
            if (hour === 7) {
                const currentSeason = window.beekeepingSystem.currentSeason;
                const seasonTasks = {
                    'æ˜¥ç¹æœŸ': ['é¤µç³–æ°´', 'èœ‚ç®±æ¸…ç†', 'æª¢æŸ¥èœ‚ç¾¤å¼·åº¦'],
                    'åˆ†èœ‚æœŸ': ['äººå·¥è‚²ç‹', 'åˆ†èœ‚ç®¡ç†', 'æ–°ç‹åŸ¹è‚²'],
                    'æ¡èœœæœŸ': ['èœœæºç®¡ç†', 'ç‰›è§’ç“œç›£æ¸¬', 'æ¡æ”¶ä½œæ¥­'],
                    'ç§‹ç¹æœŸ': ['ç§‹å­£ç¹æ®–', 'å„²å‚™è¶Šå†¬', 'èœ‚ç¾¤æ•´ä½µ'],
                    'è¶Šå†¬æœŸ': ['ä¿æº«', 'æ¸›å°‘å¹²æ“¾', 'ç›£æ¸¬å­˜æ´»']
                };
                const tasks = seasonTasks[currentSeason] || [];
                const message = `ğŸ ä»Šæ—¥èœ‚å ´ä»»å‹™
ğŸŒ¸ ${currentSeason}
âš¡ ${tasks.join('ã€')}`;
                setTimeout(() => { alert(message); }, 2000);
            }
        }

        document.addEventListener('keydown', function(e) {
            if (e.code === 'Space' && e.target.tagName !== 'INPUT' && e.target.tagName !== 'TEXTAREA') {
                e.preventDefault();
                window.beekeepingSystem.toggleRecording();
            }
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                saveRecord();
            }
            if (e.ctrlKey && e.key === 'r') {
                e.preventDefault();
                clearForm();
            }
        });

        if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            const recognition = new SpeechRecognition();
            recognition.lang = 'zh-TW';
            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.onresult = function(event) {
                const transcript = event.results[0][0].transcript;
                window.beekeepingSystem.processVoiceInput(transcript);
            };
            recognition.onerror = function(event) {
                console.error('èªéŸ³è­˜åˆ¥éŒ¯èª¤:', event.error);
                window.beekeepingSystem.showNotification('âŒ èªéŸ³è­˜åˆ¥å¤±æ•—ï¼Œè«‹é‡è©¦', 'error');
            };
            window.beekeepingSystem.toggleRecording = function() {
                if (!this.isRecording) {
                    this.isRecording = true;
                    const voiceBtn = document.getElementById('voiceBtn');
                    const voiceText = document.getElementById('voiceText');
                    voiceBtn.classList.add('recording');
                    voiceBtn.textContent = 'â¹ï¸';
                    voiceText.classList.add('listening');
                    voiceText.textContent = 'ğŸ¤ è«‹é–‹å§‹èªªè©±...';
                    recognition.start();
                } else {
                    recognition.stop();
                    this.stopRecording();
                }
            };
            recognition.onend = function() { window.beekeepingSystem.stopRecording(); };
        }

        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js').then(function(r) { console.log('ServiceWorker è¨»å†ŠæˆåŠŸ'); }).catch(function() { console.log('ServiceWorker è¨»å†Šå¤±æ•—'); });
            });
        }

        window.addEventListener('online', function() { window.beekeepingSystem.showNotification('ğŸŒ ç¶²è·¯å·²é€£ç·šï¼Œæ­£åœ¨åŒæ­¥è³‡æ–™...', 'success'); });
        window.addEventListener('offline', function() { window.beekeepingSystem.showNotification('ğŸ“± ç›®å‰é›¢ç·šæ¨¡å¼ï¼Œè³‡æ–™å°‡åœ¨é€£ç·šå¾ŒåŒæ­¥', 'warning'); });
    </script>
</body>
</html>
